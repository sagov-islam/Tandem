'use strict'


$(() => {

    // Modal --->
    $(".vacancie-btn").on('click', () => {
        $('#vacancie-modal').removeClass('modal--hide');
    })
    $(".modal .btn-close").on('click', function() {
        $(this).parent().parent().parent().parent().addClass('modal--hide');
    })
    $(".modal__bg").on('click', function(event) {
        if (event.target.classList.contains('modal__bg')) {
            $('.modal').addClass('modal--hide');
        } 
    })
    $(".input-file input[type='file']").on('change', function() {
        if ($(this).prop('files')[0]) {
            $('.input-file__button', $(this).parent()).removeClass('error');
            $('.input-file__button', $(this).parent()).addClass('success');
        };
    })


    const mb = 1048576 * 10;
    $('#vacancie-modal form').submit((event) => {
        event.preventDefault();
     
        const fileData = $('#vacancie-modal form input[type="file"]').prop('files')[0];
        const fileBtn =  $('#vacancie-modal .input-file__button');
        const modalForm = $('#vacancie-modal form');
        if (!fileData) {
            fileBtn.text('Вы не выбрали резюме');
            fileBtn.removeClass('success');
            fileBtn.addClass('error');
            return
        }
        
        if (fileData.size > (mb * 10)) {
            fileBtn.text('Файл весит больше 10 Мб');
            fileBtn.removeClass('success');
            fileBtn.addClass('error');
            return
        }

        fileBtn.text('Резюме');
        fileBtn.removeClass('error');
        fileBtn.removeClass('success');
        $(modalForm)[0].reset();

        $('#vacancie-modal').addClass('modal--hide');
        $('#success-modal').removeClass('modal--hide');
        
        setTimeout(() => {
            $('#success-modal').addClass('modal--hide');
        }, 3000) 
    })

    $('#vacancie-modal .input-file__button').on('click', function() {
        $(this).text('Резюме');
        $(this).removeClass('error');
    })

    $("#tel").mask("9 (999) 999 99-99");
  

    // Burger --->
    $('.burger__btn').on('click', function() {
        $(this).parent().toggleClass('opened');
    })


    // СТРАНИЦА: index --->
    // Слайдер партнеров
    $('#slider-companies').slick({
        prevArrow: $('.information__footer .btn-prev'),
        nextArrow: $('.information__footer .btn-next'),
        slidesToShow: 6,
        responsive: [
            {
                breakpoint: 900,
                settings: {
                    slidesToShow: 5,
                }
            },
            {
                breakpoint: 700,
                settings: {
                    slidesToShow: 4,
                }
            },
            {
                breakpoint: 600,
                settings: {
                    slidesToShow: 3,
                }
            },
            {
                breakpoint: 500,
                settings: {
                    slidesToShow: 1,
                }
            },
        ]
    });

    // Слайдер новостей
    $('#slider-news').slick({
        prevArrow: $('.news .btn-prev'),
        nextArrow: $('.news .btn-next'),
        infinite: true,
        slidesToShow: 2,
        slidesToScroll: 1,
        responsive: [
            {
                breakpoint: 1000,
                settings: {
                    slidesToShow:1,
                }
            }
        ]
    });

    // Класс для хедера при скролле
    function addClassToTheHeaderOnScroll() {
        if ($('body').scrollTop() > 140) {
            $('.header').addClass('header--scrolling');
            return
        }
        $('.header').removeClass('header--scrolling'); 
    }
    addClassToTheHeaderOnScroll();
    $('body').on('scroll', addClassToTheHeaderOnScroll);

    // Всплывающий поп-ап при наведении на отдельные регионы России
    const locations = {
        'M404.982': 'Иркуртск', 
        'M313.003': 'Томск', 
        'M222.545': 'Ханты-Мансийск',
        'M245.178': 'Тюмень',
        'M268.078': 'Ямало-Ненецкий автономный округ',
        'M253.74': 'Архангельск',
        'M196.325': 'Пермь',
        'M149.198': 'Самара',
        'M149.004': 'Оренбург',
        'M128.622': 'Саратов',
    }
    $('.geography__img-container path[fill="#6DF2E5"]').on('mouseover', function() {
        const id = $(this).attr('d').slice(0, 8).trim();
        mousePopUp(true, locations[id]);
    })
    $('.geography__img-container path[fill="#6DF2E5"]').on('mouseout', function() {
        mousePopUp(false);
    })

    function mousePopUp(turnOn, text) {
        if (turnOn === false) {
            $('body').off("mousemove");
            $('.mouse-pop-up').css({ top: 0, left:-100 });
            return
        }
        
        $('body').on('mousemove', (event) => {
            $('.mouse-pop-up').text(text);
            $('.mouse-pop-up').css({ top: event.pageY - 70, left: event.pageX - ($('.mouse-pop-up').width() / 2) - 17 });
        })
    }



    // СТРАНИЦА: activities --->
    // Слайдер деятельностей
    $('.activity__slider-list').slick({
        infinite: true,
        slidesToShow: 1,
        slidesToScroll: 1,
        arrows: true,
        dots: true,
        adaptiveHeight: false,
    });
    
    // Плавный скролл
    $('.activities__link[href^="#"]').on('click', function (e) {
        e.preventDefault();
        const id = $(this).attr('href');
        console.log(document.querySelector(id));
        document.querySelector(id).scrollIntoView({
            behavior: 'smooth',
            block: 'start'
        });
    });



    // СТРАНИЦА: about-company --->
    // Слайдер команд
    $('.team__slider').slick({
        infinite: true,
        slidesToShow: 1,
        slidesToScroll: 1,
        arrows: true,
        dots: false,
        centerMode: false,
        adaptiveHeight: false,
        prevArrow: $('.team__slider-container .btn-prev'),
        nextArrow: $('.team__slider-container .btn-next'),
        responsive: [
            {
                breakpoint: 1100,
                settings: {
                    centerMode: false,
                    
                }
            },
            {
                breakpoint: 800,
                settings: {
                    centerMode: false,
                    adaptiveHeight: true,
                    
                }
            }
        ]
    });
    $('.projects__slider').slick({
        infinite: true,
        slidesToShow: 1,
        slidesToScroll: 1,
        arrows: true,
        dots: true,
        dotsClass: 'slick-dots slider__dots',
        prevArrow: $('.projects .btns-cont .btn-prev'),
        nextArrow: $('.projects .btns-cont .btn-next'),
        // responsive: [
        //     {
        //         breakpoint: 800,
        //         settings: {
        //             adaptiveHeight: true,
        //         }
        //     }
        // ]
    });

    // $('.projects__item-text').each(function(index, item) {
    //     const height = Math.round($(item).height());
    //     const scrollHeight = $(item).prop('scrollHeight');
    //     if (scrollHeight > height) $('.canScroll', item).css({ display: 'inline-block' });
    // })


    // СТРАНИЦА: career --->
    // Слайдер школы
    $('.school__slider').slick({
        infinite: true,
        slidesToShow: 1,
        arrows: false,
        dots: false,
        autoplay: true,
        autoplaySpeed: 2500,
        fade: true,
    });
    

    // Слайдер работников
    $('.workers__slider').slick({
        infinite: true,
        slidesToShow: 1,
        slidesToScroll: 1,
        speed: 300,
        arrows: true,
        prevArrow: $('.workers__btns .btn-prev'),
        nextArrow: $('.workers__btns .btn-next'),
        adaptiveHeight: true,
    });

    // Аккордеон
    const accordionButtons = $('.vacancies__accordion-btn');
    const accordionTexts = $('.vacancies__accordion-text');
  
    function RunAccordion(buttons, texts) {
        for (let i = 0; i < $(buttons).length; i++) {
            const button = $(buttons)[i];
            const text = $(texts)[i];

            $(button).on('click', () => {
                
                $(button).toggleClass('hide');
                $(button).parent().toggleClass('dark');
                const textClosed = $(button).hasClass('hide');
                
                $(text).css('height', textClosed ? '0px' : `${text.scrollHeight + 30}px`)
            }) 
        }
    }
    RunAccordion(accordionButtons, accordionTexts);

    // СТРАНИЦА: news --->
    function updateButtons(parent) {
        const btnShowMore = $('.btn[data-news-btn="showMore"]', parent);
        const btnShowLess = $('.btn[data-news-btn="showLess"]', parent);
        $(btnShowLess).toggleClass('d-none');
        $(btnShowMore).toggleClass('d-none');
    }
    

    $('.news-block__item-text-container').each((index, item) => {
        // $('p:first-child, p:last-child', item).remove();

        const btn = $('.btn[data-news-btn="showMore"]', $(item).parent());
        const height = Math.round($(item).height());
        const scrollHeight = $(item).prop('scrollHeight');
        
        if (height == scrollHeight) {
           $(btn).remove();
        }
       
    })

    $('.news-block__item .btn[data-news-btn="showMore"]').on('click', function() {
        const parent = $(this).parent();
        const textContainer = $('.news-block__item-text-container', parent);
        const height = Math.round((textContainer).height());
        const scrollHeight = textContainer[0].scrollHeight;
        if (height !== scrollHeight && scrollHeight > height) {
           $(textContainer).css({
            height: scrollHeight,
           })
           updateButtons(parent);
        }
     
    })

    $('.news-block__item .btn[data-news-btn="showLess"]').on('click', function() {
        const parent = $(this).parent();
        const textContainer = $('.news-block__item-text-container', parent);
        $(textContainer).css({
            height: '90px',
        })
        updateButtons(parent);
    })
})
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiIiwic291cmNlcyI6WyJzY3JpcHQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXHJcblxyXG5cclxuJCgoKSA9PiB7XHJcblxyXG4gICAgLy8gTW9kYWwgLS0tPlxyXG4gICAgJChcIi52YWNhbmNpZS1idG5cIikub24oJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICQoJyN2YWNhbmNpZS1tb2RhbCcpLnJlbW92ZUNsYXNzKCdtb2RhbC0taGlkZScpO1xyXG4gICAgfSlcclxuICAgICQoXCIubW9kYWwgLmJ0bi1jbG9zZVwiKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdtb2RhbC0taGlkZScpO1xyXG4gICAgfSlcclxuICAgICQoXCIubW9kYWxfX2JnXCIpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2ZW50KSB7XHJcbiAgICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19iZycpKSB7XHJcbiAgICAgICAgICAgICQoJy5tb2RhbCcpLmFkZENsYXNzKCdtb2RhbC0taGlkZScpO1xyXG4gICAgICAgIH0gXHJcbiAgICB9KVxyXG4gICAgJChcIi5pbnB1dC1maWxlIGlucHV0W3R5cGU9J2ZpbGUnXVwiKS5vbignY2hhbmdlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgaWYgKCQodGhpcykucHJvcCgnZmlsZXMnKVswXSkge1xyXG4gICAgICAgICAgICAkKCcuaW5wdXQtZmlsZV9fYnV0dG9uJywgJCh0aGlzKS5wYXJlbnQoKSkucmVtb3ZlQ2xhc3MoJ2Vycm9yJyk7XHJcbiAgICAgICAgICAgICQoJy5pbnB1dC1maWxlX19idXR0b24nLCAkKHRoaXMpLnBhcmVudCgpKS5hZGRDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgIH07XHJcbiAgICB9KVxyXG5cclxuXHJcbiAgICBjb25zdCBtYiA9IDEwNDg1NzYgKiAxMDtcclxuICAgICQoJyN2YWNhbmNpZS1tb2RhbCBmb3JtJykuc3VibWl0KChldmVudCkgPT4ge1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgXHJcbiAgICAgICAgY29uc3QgZmlsZURhdGEgPSAkKCcjdmFjYW5jaWUtbW9kYWwgZm9ybSBpbnB1dFt0eXBlPVwiZmlsZVwiXScpLnByb3AoJ2ZpbGVzJylbMF07XHJcbiAgICAgICAgY29uc3QgZmlsZUJ0biA9ICAkKCcjdmFjYW5jaWUtbW9kYWwgLmlucHV0LWZpbGVfX2J1dHRvbicpO1xyXG4gICAgICAgIGNvbnN0IG1vZGFsRm9ybSA9ICQoJyN2YWNhbmNpZS1tb2RhbCBmb3JtJyk7XHJcbiAgICAgICAgaWYgKCFmaWxlRGF0YSkge1xyXG4gICAgICAgICAgICBmaWxlQnRuLnRleHQoJ9CS0Ysg0L3QtSDQstGL0LHRgNCw0LvQuCDRgNC10LfRjtC80LUnKTtcclxuICAgICAgICAgICAgZmlsZUJ0bi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgICAgICBmaWxlQnRuLmFkZENsYXNzKCdlcnJvcicpO1xyXG4gICAgICAgICAgICByZXR1cm5cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGZpbGVEYXRhLnNpemUgPiAobWIgKiAxMCkpIHtcclxuICAgICAgICAgICAgZmlsZUJ0bi50ZXh0KCfQpNCw0LnQuyDQstC10YHQuNGCINCx0L7Qu9GM0YjQtSAxMCDQnNCxJyk7XHJcbiAgICAgICAgICAgIGZpbGVCdG4ucmVtb3ZlQ2xhc3MoJ3N1Y2Nlc3MnKTtcclxuICAgICAgICAgICAgZmlsZUJ0bi5hZGRDbGFzcygnZXJyb3InKTtcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmaWxlQnRuLnRleHQoJ9Cg0LXQt9GO0LzQtScpO1xyXG4gICAgICAgIGZpbGVCdG4ucmVtb3ZlQ2xhc3MoJ2Vycm9yJyk7XHJcbiAgICAgICAgZmlsZUJ0bi5yZW1vdmVDbGFzcygnc3VjY2VzcycpO1xyXG4gICAgICAgICQobW9kYWxGb3JtKVswXS5yZXNldCgpO1xyXG5cclxuICAgICAgICAkKCcjdmFjYW5jaWUtbW9kYWwnKS5hZGRDbGFzcygnbW9kYWwtLWhpZGUnKTtcclxuICAgICAgICAkKCcjc3VjY2Vzcy1tb2RhbCcpLnJlbW92ZUNsYXNzKCdtb2RhbC0taGlkZScpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAkKCcjc3VjY2Vzcy1tb2RhbCcpLmFkZENsYXNzKCdtb2RhbC0taGlkZScpO1xyXG4gICAgICAgIH0sIDMwMDApIFxyXG4gICAgfSlcclxuXHJcbiAgICAkKCcjdmFjYW5jaWUtbW9kYWwgLmlucHV0LWZpbGVfX2J1dHRvbicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICQodGhpcykudGV4dCgn0KDQtdC30Y7QvNC1Jyk7XHJcbiAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnZXJyb3InKTtcclxuICAgIH0pXHJcblxyXG4gICAgJChcIiN0ZWxcIikubWFzayhcIjkgKDk5OSkgOTk5IDk5LTk5XCIpO1xyXG4gIFxyXG5cclxuICAgIC8vIEJ1cmdlciAtLS0+XHJcbiAgICAkKCcuYnVyZ2VyX19idG4nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAkKHRoaXMpLnBhcmVudCgpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTtcclxuICAgIH0pXHJcblxyXG5cclxuICAgIC8vINCh0KLQoNCQ0J3QmNCm0JA6IGluZGV4IC0tLT5cclxuICAgIC8vINCh0LvQsNC50LTQtdGAINC/0LDRgNGC0L3QtdGA0L7QslxyXG4gICAgJCgnI3NsaWRlci1jb21wYW5pZXMnKS5zbGljayh7XHJcbiAgICAgICAgcHJldkFycm93OiAkKCcuaW5mb3JtYXRpb25fX2Zvb3RlciAuYnRuLXByZXYnKSxcclxuICAgICAgICBuZXh0QXJyb3c6ICQoJy5pbmZvcm1hdGlvbl9fZm9vdGVyIC5idG4tbmV4dCcpLFxyXG4gICAgICAgIHNsaWRlc1RvU2hvdzogNixcclxuICAgICAgICByZXNwb25zaXZlOiBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDkwMCxcclxuICAgICAgICAgICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiA1LFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBicmVha3BvaW50OiA3MDAsXHJcbiAgICAgICAgICAgICAgICBzZXR0aW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIHNsaWRlc1RvU2hvdzogNCxcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnJlYWtwb2ludDogNjAwLFxyXG4gICAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBzbGlkZXNUb1Nob3c6IDMsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGJyZWFrcG9pbnQ6IDUwMCxcclxuICAgICAgICAgICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OiAxLFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgIF1cclxuICAgIH0pO1xyXG5cclxuICAgIC8vINCh0LvQsNC50LTQtdGAINC90L7QstC+0YHRgtC10LlcclxuICAgICQoJyNzbGlkZXItbmV3cycpLnNsaWNrKHtcclxuICAgICAgICBwcmV2QXJyb3c6ICQoJy5uZXdzIC5idG4tcHJldicpLFxyXG4gICAgICAgIG5leHRBcnJvdzogJCgnLm5ld3MgLmJ0bi1uZXh0JyksXHJcbiAgICAgICAgaW5maW5pdGU6IHRydWUsXHJcbiAgICAgICAgc2xpZGVzVG9TaG93OiAyLFxyXG4gICAgICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxyXG4gICAgICAgIHJlc3BvbnNpdmU6IFtcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnJlYWtwb2ludDogMTAwMCxcclxuICAgICAgICAgICAgICAgIHNldHRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2xpZGVzVG9TaG93OjEsXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICBdXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDQmtC70LDRgdGBINC00LvRjyDRhdC10LTQtdGA0LAg0L/RgNC4INGB0LrRgNC+0LvQu9C1XHJcbiAgICBmdW5jdGlvbiBhZGRDbGFzc1RvVGhlSGVhZGVyT25TY3JvbGwoKSB7XHJcbiAgICAgICAgaWYgKCQoJ2JvZHknKS5zY3JvbGxUb3AoKSA+IDE0MCkge1xyXG4gICAgICAgICAgICAkKCcuaGVhZGVyJykuYWRkQ2xhc3MoJ2hlYWRlci0tc2Nyb2xsaW5nJyk7XHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICAkKCcuaGVhZGVyJykucmVtb3ZlQ2xhc3MoJ2hlYWRlci0tc2Nyb2xsaW5nJyk7IFxyXG4gICAgfVxyXG4gICAgYWRkQ2xhc3NUb1RoZUhlYWRlck9uU2Nyb2xsKCk7XHJcbiAgICAkKCdib2R5Jykub24oJ3Njcm9sbCcsIGFkZENsYXNzVG9UaGVIZWFkZXJPblNjcm9sbCk7XHJcblxyXG4gICAgLy8g0JLRgdC/0LvRi9Cy0LDRjtGJ0LjQuSDQv9C+0L8t0LDQvyDQv9GA0Lgg0L3QsNCy0LXQtNC10L3QuNC4INC90LAg0L7RgtC00LXQu9GM0L3Ri9C1INGA0LXQs9C40L7QvdGLINCg0L7RgdGB0LjQuFxyXG4gICAgY29uc3QgbG9jYXRpb25zID0ge1xyXG4gICAgICAgICdNNDA0Ljk4Mic6ICfQmNGA0LrRg9GA0YLRgdC6JywgXHJcbiAgICAgICAgJ00zMTMuMDAzJzogJ9Ci0L7QvNGB0LonLCBcclxuICAgICAgICAnTTIyMi41NDUnOiAn0KXQsNC90YLRiy3QnNCw0L3RgdC40LnRgdC6JyxcclxuICAgICAgICAnTTI0NS4xNzgnOiAn0KLRjtC80LXQvdGMJyxcclxuICAgICAgICAnTTI2OC4wNzgnOiAn0K/QvNCw0LvQvi3QndC10L3QtdGG0LrQuNC5INCw0LLRgtC+0L3QvtC80L3Ri9C5INC+0LrRgNGD0LMnLFxyXG4gICAgICAgICdNMjUzLjc0JzogJ9CQ0YDRhdCw0L3Qs9C10LvRjNGB0LonLFxyXG4gICAgICAgICdNMTk2LjMyNSc6ICfQn9C10YDQvNGMJyxcclxuICAgICAgICAnTTE0OS4xOTgnOiAn0KHQsNC80LDRgNCwJyxcclxuICAgICAgICAnTTE0OS4wMDQnOiAn0J7RgNC10L3QsdGD0YDQsycsXHJcbiAgICAgICAgJ00xMjguNjIyJzogJ9Ch0LDRgNCw0YLQvtCyJyxcclxuICAgIH1cclxuICAgICQoJy5nZW9ncmFwaHlfX2ltZy1jb250YWluZXIgcGF0aFtmaWxsPVwiIzZERjJFNVwiXScpLm9uKCdtb3VzZW92ZXInLCBmdW5jdGlvbigpIHtcclxuICAgICAgICBjb25zdCBpZCA9ICQodGhpcykuYXR0cignZCcpLnNsaWNlKDAsIDgpLnRyaW0oKTtcclxuICAgICAgICBtb3VzZVBvcFVwKHRydWUsIGxvY2F0aW9uc1tpZF0pO1xyXG4gICAgfSlcclxuICAgICQoJy5nZW9ncmFwaHlfX2ltZy1jb250YWluZXIgcGF0aFtmaWxsPVwiIzZERjJFNVwiXScpLm9uKCdtb3VzZW91dCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgIG1vdXNlUG9wVXAoZmFsc2UpO1xyXG4gICAgfSlcclxuXHJcbiAgICBmdW5jdGlvbiBtb3VzZVBvcFVwKHR1cm5PbiwgdGV4dCkge1xyXG4gICAgICAgIGlmICh0dXJuT24gPT09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICQoJ2JvZHknKS5vZmYoXCJtb3VzZW1vdmVcIik7XHJcbiAgICAgICAgICAgICQoJy5tb3VzZS1wb3AtdXAnKS5jc3MoeyB0b3A6IDAsIGxlZnQ6LTEwMCB9KTtcclxuICAgICAgICAgICAgcmV0dXJuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgICQoJ2JvZHknKS5vbignbW91c2Vtb3ZlJywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICQoJy5tb3VzZS1wb3AtdXAnKS50ZXh0KHRleHQpO1xyXG4gICAgICAgICAgICAkKCcubW91c2UtcG9wLXVwJykuY3NzKHsgdG9wOiBldmVudC5wYWdlWSAtIDcwLCBsZWZ0OiBldmVudC5wYWdlWCAtICgkKCcubW91c2UtcG9wLXVwJykud2lkdGgoKSAvIDIpIC0gMTcgfSk7XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcblxyXG5cclxuICAgIC8vINCh0KLQoNCQ0J3QmNCm0JA6IGFjdGl2aXRpZXMgLS0tPlxyXG4gICAgLy8g0KHQu9Cw0LnQtNC10YAg0LTQtdGP0YLQtdC70YzQvdC+0YHRgtC10LlcclxuICAgICQoJy5hY3Rpdml0eV9fc2xpZGVyLWxpc3QnKS5zbGljayh7XHJcbiAgICAgICAgaW5maW5pdGU6IHRydWUsXHJcbiAgICAgICAgc2xpZGVzVG9TaG93OiAxLFxyXG4gICAgICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxyXG4gICAgICAgIGFycm93czogdHJ1ZSxcclxuICAgICAgICBkb3RzOiB0cnVlLFxyXG4gICAgICAgIGFkYXB0aXZlSGVpZ2h0OiBmYWxzZSxcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAvLyDQn9C70LDQstC90YvQuSDRgdC60YDQvtC70LtcclxuICAgICQoJy5hY3Rpdml0aWVzX19saW5rW2hyZWZePVwiI1wiXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIGNvbnN0IGlkID0gJCh0aGlzKS5hdHRyKCdocmVmJyk7XHJcbiAgICAgICAgY29uc29sZS5sb2coZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpZCkpO1xyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaWQpLnNjcm9sbEludG9WaWV3KHtcclxuICAgICAgICAgICAgYmVoYXZpb3I6ICdzbW9vdGgnLFxyXG4gICAgICAgICAgICBibG9jazogJ3N0YXJ0J1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG5cclxuXHJcbiAgICAvLyDQodCi0KDQkNCd0JjQptCQOiBhYm91dC1jb21wYW55IC0tLT5cclxuICAgIC8vINCh0LvQsNC50LTQtdGAINC60L7QvNCw0L3QtFxyXG4gICAgJCgnLnRlYW1fX3NsaWRlcicpLnNsaWNrKHtcclxuICAgICAgICBpbmZpbml0ZTogdHJ1ZSxcclxuICAgICAgICBzbGlkZXNUb1Nob3c6IDEsXHJcbiAgICAgICAgc2xpZGVzVG9TY3JvbGw6IDEsXHJcbiAgICAgICAgYXJyb3dzOiB0cnVlLFxyXG4gICAgICAgIGRvdHM6IGZhbHNlLFxyXG4gICAgICAgIGNlbnRlck1vZGU6IGZhbHNlLFxyXG4gICAgICAgIGFkYXB0aXZlSGVpZ2h0OiBmYWxzZSxcclxuICAgICAgICBwcmV2QXJyb3c6ICQoJy50ZWFtX19zbGlkZXItY29udGFpbmVyIC5idG4tcHJldicpLFxyXG4gICAgICAgIG5leHRBcnJvdzogJCgnLnRlYW1fX3NsaWRlci1jb250YWluZXIgLmJ0bi1uZXh0JyksXHJcbiAgICAgICAgcmVzcG9uc2l2ZTogW1xyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBicmVha3BvaW50OiAxMTAwLFxyXG4gICAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBjZW50ZXJNb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgYnJlYWtwb2ludDogODAwLFxyXG4gICAgICAgICAgICAgICAgc2V0dGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBjZW50ZXJNb2RlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBhZGFwdGl2ZUhlaWdodDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIF1cclxuICAgIH0pO1xyXG4gICAgJCgnLnByb2plY3RzX19zbGlkZXInKS5zbGljayh7XHJcbiAgICAgICAgaW5maW5pdGU6IHRydWUsXHJcbiAgICAgICAgc2xpZGVzVG9TaG93OiAxLFxyXG4gICAgICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxyXG4gICAgICAgIGFycm93czogdHJ1ZSxcclxuICAgICAgICBkb3RzOiB0cnVlLFxyXG4gICAgICAgIGRvdHNDbGFzczogJ3NsaWNrLWRvdHMgc2xpZGVyX19kb3RzJyxcclxuICAgICAgICBwcmV2QXJyb3c6ICQoJy5wcm9qZWN0cyAuYnRucy1jb250IC5idG4tcHJldicpLFxyXG4gICAgICAgIG5leHRBcnJvdzogJCgnLnByb2plY3RzIC5idG5zLWNvbnQgLmJ0bi1uZXh0JyksXHJcbiAgICAgICAgLy8gcmVzcG9uc2l2ZTogW1xyXG4gICAgICAgIC8vICAgICB7XHJcbiAgICAgICAgLy8gICAgICAgICBicmVha3BvaW50OiA4MDAsXHJcbiAgICAgICAgLy8gICAgICAgICBzZXR0aW5nczoge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgIGFkYXB0aXZlSGVpZ2h0OiB0cnVlLFxyXG4gICAgICAgIC8vICAgICAgICAgfVxyXG4gICAgICAgIC8vICAgICB9XHJcbiAgICAgICAgLy8gXVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gJCgnLnByb2plY3RzX19pdGVtLXRleHQnKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCBpdGVtKSB7XHJcbiAgICAvLyAgICAgY29uc3QgaGVpZ2h0ID0gTWF0aC5yb3VuZCgkKGl0ZW0pLmhlaWdodCgpKTtcclxuICAgIC8vICAgICBjb25zdCBzY3JvbGxIZWlnaHQgPSAkKGl0ZW0pLnByb3AoJ3Njcm9sbEhlaWdodCcpO1xyXG4gICAgLy8gICAgIGlmIChzY3JvbGxIZWlnaHQgPiBoZWlnaHQpICQoJy5jYW5TY3JvbGwnLCBpdGVtKS5jc3MoeyBkaXNwbGF5OiAnaW5saW5lLWJsb2NrJyB9KTtcclxuICAgIC8vIH0pXHJcblxyXG5cclxuICAgIC8vINCh0KLQoNCQ0J3QmNCm0JA6IGNhcmVlciAtLS0+XHJcbiAgICAvLyDQodC70LDQudC00LXRgCDRiNC60L7Qu9GLXHJcbiAgICAkKCcuc2Nob29sX19zbGlkZXInKS5zbGljayh7XHJcbiAgICAgICAgaW5maW5pdGU6IHRydWUsXHJcbiAgICAgICAgc2xpZGVzVG9TaG93OiAxLFxyXG4gICAgICAgIGFycm93czogZmFsc2UsXHJcbiAgICAgICAgZG90czogZmFsc2UsXHJcbiAgICAgICAgYXV0b3BsYXk6IHRydWUsXHJcbiAgICAgICAgYXV0b3BsYXlTcGVlZDogMjUwMCxcclxuICAgICAgICBmYWRlOiB0cnVlLFxyXG4gICAgfSk7XHJcbiAgICBcclxuXHJcbiAgICAvLyDQodC70LDQudC00LXRgCDRgNCw0LHQvtGC0L3QuNC60L7QslxyXG4gICAgJCgnLndvcmtlcnNfX3NsaWRlcicpLnNsaWNrKHtcclxuICAgICAgICBpbmZpbml0ZTogdHJ1ZSxcclxuICAgICAgICBzbGlkZXNUb1Nob3c6IDEsXHJcbiAgICAgICAgc2xpZGVzVG9TY3JvbGw6IDEsXHJcbiAgICAgICAgc3BlZWQ6IDMwMCxcclxuICAgICAgICBhcnJvd3M6IHRydWUsXHJcbiAgICAgICAgcHJldkFycm93OiAkKCcud29ya2Vyc19fYnRucyAuYnRuLXByZXYnKSxcclxuICAgICAgICBuZXh0QXJyb3c6ICQoJy53b3JrZXJzX19idG5zIC5idG4tbmV4dCcpLFxyXG4gICAgICAgIGFkYXB0aXZlSGVpZ2h0OiB0cnVlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8g0JDQutC60L7RgNC00LXQvtC9XHJcbiAgICBjb25zdCBhY2NvcmRpb25CdXR0b25zID0gJCgnLnZhY2FuY2llc19fYWNjb3JkaW9uLWJ0bicpO1xyXG4gICAgY29uc3QgYWNjb3JkaW9uVGV4dHMgPSAkKCcudmFjYW5jaWVzX19hY2NvcmRpb24tdGV4dCcpO1xyXG4gIFxyXG4gICAgZnVuY3Rpb24gUnVuQWNjb3JkaW9uKGJ1dHRvbnMsIHRleHRzKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAkKGJ1dHRvbnMpLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9ICQoYnV0dG9ucylbaV07XHJcbiAgICAgICAgICAgIGNvbnN0IHRleHQgPSAkKHRleHRzKVtpXTtcclxuXHJcbiAgICAgICAgICAgICQoYnV0dG9uKS5vbignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICQoYnV0dG9uKS50b2dnbGVDbGFzcygnaGlkZScpO1xyXG4gICAgICAgICAgICAgICAgJChidXR0b24pLnBhcmVudCgpLnRvZ2dsZUNsYXNzKCdkYXJrJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0Q2xvc2VkID0gJChidXR0b24pLmhhc0NsYXNzKCdoaWRlJyk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICQodGV4dCkuY3NzKCdoZWlnaHQnLCB0ZXh0Q2xvc2VkID8gJzBweCcgOiBgJHt0ZXh0LnNjcm9sbEhlaWdodCArIDMwfXB4YClcclxuICAgICAgICAgICAgfSkgXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgUnVuQWNjb3JkaW9uKGFjY29yZGlvbkJ1dHRvbnMsIGFjY29yZGlvblRleHRzKTtcclxuXHJcbiAgICAvLyDQodCi0KDQkNCd0JjQptCQOiBuZXdzIC0tLT5cclxuICAgIGZ1bmN0aW9uIHVwZGF0ZUJ1dHRvbnMocGFyZW50KSB7XHJcbiAgICAgICAgY29uc3QgYnRuU2hvd01vcmUgPSAkKCcuYnRuW2RhdGEtbmV3cy1idG49XCJzaG93TW9yZVwiXScsIHBhcmVudCk7XHJcbiAgICAgICAgY29uc3QgYnRuU2hvd0xlc3MgPSAkKCcuYnRuW2RhdGEtbmV3cy1idG49XCJzaG93TGVzc1wiXScsIHBhcmVudCk7XHJcbiAgICAgICAgJChidG5TaG93TGVzcykudG9nZ2xlQ2xhc3MoJ2Qtbm9uZScpO1xyXG4gICAgICAgICQoYnRuU2hvd01vcmUpLnRvZ2dsZUNsYXNzKCdkLW5vbmUnKTtcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgICQoJy5uZXdzLWJsb2NrX19pdGVtLXRleHQtY29udGFpbmVyJykuZWFjaCgoaW5kZXgsIGl0ZW0pID0+IHtcclxuICAgICAgICAvLyAkKCdwOmZpcnN0LWNoaWxkLCBwOmxhc3QtY2hpbGQnLCBpdGVtKS5yZW1vdmUoKTtcclxuXHJcbiAgICAgICAgY29uc3QgYnRuID0gJCgnLmJ0bltkYXRhLW5ld3MtYnRuPVwic2hvd01vcmVcIl0nLCAkKGl0ZW0pLnBhcmVudCgpKTtcclxuICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLnJvdW5kKCQoaXRlbSkuaGVpZ2h0KCkpO1xyXG4gICAgICAgIGNvbnN0IHNjcm9sbEhlaWdodCA9ICQoaXRlbSkucHJvcCgnc2Nyb2xsSGVpZ2h0Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKGhlaWdodCA9PSBzY3JvbGxIZWlnaHQpIHtcclxuICAgICAgICAgICAkKGJ0bikucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgXHJcbiAgICB9KVxyXG5cclxuICAgICQoJy5uZXdzLWJsb2NrX19pdGVtIC5idG5bZGF0YS1uZXdzLWJ0bj1cInNob3dNb3JlXCJdJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc3QgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gJCgnLm5ld3MtYmxvY2tfX2l0ZW0tdGV4dC1jb250YWluZXInLCBwYXJlbnQpO1xyXG4gICAgICAgIGNvbnN0IGhlaWdodCA9IE1hdGgucm91bmQoKHRleHRDb250YWluZXIpLmhlaWdodCgpKTtcclxuICAgICAgICBjb25zdCBzY3JvbGxIZWlnaHQgPSB0ZXh0Q29udGFpbmVyWzBdLnNjcm9sbEhlaWdodDtcclxuICAgICAgICBpZiAoaGVpZ2h0ICE9PSBzY3JvbGxIZWlnaHQgJiYgc2Nyb2xsSGVpZ2h0ID4gaGVpZ2h0KSB7XHJcbiAgICAgICAgICAgJCh0ZXh0Q29udGFpbmVyKS5jc3Moe1xyXG4gICAgICAgICAgICBoZWlnaHQ6IHNjcm9sbEhlaWdodCxcclxuICAgICAgICAgICB9KVxyXG4gICAgICAgICAgIHVwZGF0ZUJ1dHRvbnMocGFyZW50KTtcclxuICAgICAgICB9XHJcbiAgICAgXHJcbiAgICB9KVxyXG5cclxuICAgICQoJy5uZXdzLWJsb2NrX19pdGVtIC5idG5bZGF0YS1uZXdzLWJ0bj1cInNob3dMZXNzXCJdJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgY29uc3QgcGFyZW50ID0gJCh0aGlzKS5wYXJlbnQoKTtcclxuICAgICAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gJCgnLm5ld3MtYmxvY2tfX2l0ZW0tdGV4dC1jb250YWluZXInLCBwYXJlbnQpO1xyXG4gICAgICAgICQodGV4dENvbnRhaW5lcikuY3NzKHtcclxuICAgICAgICAgICAgaGVpZ2h0OiAnOTBweCcsXHJcbiAgICAgICAgfSlcclxuICAgICAgICB1cGRhdGVCdXR0b25zKHBhcmVudCk7XHJcbiAgICB9KVxyXG59KSJdLCJmaWxlIjoic2NyaXB0Lm1pbi5qcyJ9
